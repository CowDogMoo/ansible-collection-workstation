---
claude_code_username: "{{ ansible_user_id | default(ansible_user) }}"
claude_code_usergroup: "{{ (ansible_facts['os_family'] == 'Darwin') | ternary('staff', claude_code_username) }}"
claude_code_user_home: >-
  {{ (ansible_facts['os_family'] == 'Darwin') | ternary(ansible_env.HOME,
     (claude_code_username == 'root') | ternary('/root', '/home/' + claude_code_username)) }}

# Configuration directory for Claude Code
claude_code_config_dir: "{{ claude_code_user_home }}/.claude"

# Whether to install Claude Code CLI
claude_code_install: true

# Whether to manage Claude Code settings
claude_code_manage_settings: true

# Whether to backup existing settings before overwriting
claude_code_backup_settings: true

# Simple hooks - easy YAML configuration
claude_code_simple_hooks: []

# Advanced hooks - custom Python/shell scripts
claude_code_advanced_hooks:
  # Hook 1: Block commits/PRs with forbidden content (emojis/branding)
  - event: PreToolUse
    tool: Bash
    type: command
    command: 'python3 -c "import json, sys; data=json.load(sys.stdin); cmd=data.get(''tool_input'',{}).get(''command'',''''); forbidden=[''ü§ñ'',''Generated with'',''Co-Authored-By: Claude'',''claude.com/claude-code'']; msg=''‚ùå BLOCKED: Forbidden content (emojis/branding)\\n\\n‚úÖ Use ONLY fabric output\\nGenerate: git diff --staged | fabric --pattern commit'' if ''git commit'' in cmd and ''-m'' in cmd and any(f in cmd for f in forbidden) else ''‚ùå BLOCKED: Forbidden content (emojis/branding)\\n\\n‚úÖ Use ONLY fabric output\\nGenerate: git diff main...HEAD | fabric --pattern pr'' if ''gh pr create'' in cmd and ''--body'' in cmd and any(f in cmd for f in forbidden) else ''''; sys.stderr.write(msg) if msg else None; sys.exit(2 if msg else 0)"'
  # Hook 2: Require fabric for all PR creation
  - event: PreToolUse
    tool: Bash
    type: command
    command: 'python3 -c "import json, sys; data=json.load(sys.stdin); cmd=data.get(''tool_input'',{}).get(''command'',''''); msg=''‚ùå BLOCKED: Must use fabric to generate PR content\\n\\n‚úÖ Required workflow:\\n   1. Generate PR content: git diff main...HEAD | fabric --pattern pr\\n   2. Parse the fabric output to extract title and body\\n   3. Use extracted content: gh pr create --title \"...\" --body \"...\"\\n\\nExample:\\n   pr_content=$(git diff main...HEAD | fabric --pattern pr)\\n   # Parse pr_content to get title and body, then use in gh pr create'' if ''gh pr create'' in cmd else ''''; sys.stderr.write(msg) if msg else None; sys.exit(2 if msg else 0)"'

# Additional settings (optional)
claude_code_additional_settings: {}
