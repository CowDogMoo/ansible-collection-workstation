---
claude_code_username: "{{ ansible_facts['user_id'] | default(ansible_facts['user']) }}"
claude_code_usergroup: "{{ (ansible_facts['os_family'] == 'Darwin') | ternary('staff', claude_code_username) }}"
claude_code_user_home: >-
  {{ (ansible_facts['os_family'] == 'Darwin') | ternary(ansible_facts['env']['HOME'],
     (claude_code_username == 'root') | ternary('/root', '/home/' + claude_code_username)) }}

# Configuration directory for Claude Code
claude_code_config_dir: "{{ claude_code_user_home }}/.claude"

# Whether to install Claude Code CLI
claude_code_install: true

# Whether to manage Claude Code settings
claude_code_manage_settings: true

# Whether to backup existing settings before overwriting
claude_code_backup_settings: true

# Simple hooks - easy YAML configuration
claude_code_simple_hooks: []

# Advanced hooks - custom Python/shell scripts
claude_code_advanced_hooks:
  # Hook 1: Block commits/PRs with forbidden content (emojis/branding)
  - event: PreToolUse
    tool: Bash
    type: command
    command: |
      python3 -c "
      import json, sys

      data = json.load(sys.stdin)
      cmd = data.get('tool_input', {}).get('command', '')

      forbidden = ['ü§ñ', 'Generated with', 'Co-Authored-By: Claude', 'claude.com/claude-code']

      msg = ''
      if 'git commit' in cmd and '-m' in cmd and any(f in cmd for f in forbidden):
          msg = '‚ùå BLOCKED: Forbidden content (emojis/branding)\\n\\n‚úÖ Use ONLY fabric output\\nGenerate: git diff --staged | fabric --pattern commit'
      elif 'gh pr create' in cmd and '--body' in cmd and any(f in cmd for f in forbidden):
          msg = '‚ùå BLOCKED: Forbidden content (emojis/branding)\\n\\n‚úÖ Use ONLY fabric output\\nGenerate: git diff main...HEAD | fabric --pattern pr'

      if msg:
          sys.stderr.write(msg + '\n')
          sys.exit(2)
      sys.exit(0)
      "

# Additional settings (optional)
claude_code_additional_settings: {}
