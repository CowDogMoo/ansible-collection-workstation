{
  $schema: "https://docs.renovatebot.com/renovate-schema.json",
  extends: [
    "config:best-practices",
    "docker:enableMajor",
    ":dependencyDashboard",
    ":semanticCommits",
    ":enablePreCommit",
    ":automergeDigest",
    "helpers:pinGitHubActionDigests"
  ],
  dependencyDashboardLabels: ["renovate"],
  dependencyDashboardTitle: "Renovate Dashboard ðŸ¤–",
  suppressNotifications: ["prIgnoreNotification"],
  rebaseWhen: "conflicted",
  commitBodyTable: true,
  labels: ["renovate"],

  packageRules: [
    { matchDatasources: ["galaxy"], matchUpdateTypes: ["digest"], automerge: true, automergeType: "pr" },
    { matchManagers: ["github-actions"], matchDatasources: ["github-tags"], matchUpdateTypes: ["minor","patch"], automerge: true, automergeType: "pr" },
    { matchManagers: ["ansible-galaxy"], groupName: "ansible-dependencies" },
    { matchDatasources: ["github-runners"], enabled: false } // silence ubuntu-latest etc.
  ],

  customManagers: [
    {
      // Asdf defaults file: pull datasource/depName from the inline hint
      customType: "regex",
      managerFilePatterns: ["/roles/asdf/defaults/main\\.yml$"],
      matchStrings: [
        "# renovate: datasource=(?<datasource>\\S+) depName=(?<depName>\\S+)(?: versioning=(?<versioning>\\S+))?(?: extractVersion=(?<extractVersion>\\S+))?\\s+- name:\\s*\\S+\\s+version:\\s*[\"']?(?<currentValue>[^\"'\\s]+)[\"']?"
      ],
      versioningTemplate: "{{#if versioning}}{{{versioning}}}{{else}}semver{{/if}}"
    },

    // Workflow: python-version
    {
      customType: "regex",
      managerFilePatterns: ["/\\.github/workflows/.*\\.ya?ml$"],
      matchStrings: [
        "\\bpython-version:\\s*['\"]?(?<currentValue>\\d+(?:\\.\\d+){1,2})['\"]?"
      ],
      datasourceTemplate: "python-version",
      depNameTemplate: "python",
      versioningTemplate: "python"
    },

    // Workflow: go-version
    {
      customType: "regex",
      managerFilePatterns: ["/\\.github/workflows/.*\\.ya?ml$"],
      matchStrings: [
        "\\bgo-version:\\s*['\"]?(?<currentValue>\\d+(?:\\.\\d+){1,2})['\"]?"
      ],
      datasourceTemplate: "golang-version",
      depNameTemplate: "go",
      versioningTemplate: "semver"
    }
  ]
}
