---
- name: Workstation
  hosts: all
  pre_tasks:
    - name: Get primary group name of the user
      ansible.builtin.command: id -gn "{{ ansible_user_id }}"
      changed_when: false
      register: primary_group_name
  roles:
    - role: cowdogmoo.workstation.user_setup
    - role: cowdogmoo.workstation.package_management
    - role: cowdogmoo.workstation.zsh_setup
      vars:
        zsh_setup_users:
          - username: "{{ ansible_user_id }}"
            usergroup: "{{ primary_group_name.stdout }}"
    - role: cowdogmoo.workstation.asdf
      vars:
        asdf_users:
          - username: "{{ ansible_env.USER if ansible_distribution == 'mac' else asdf_default_username }}"
            usergroup: "{{ 'staff' if ansible_distribution == 'mac' else asdf_default_group }}"
            shell: "/bin/zsh"
            plugins:
              - name: golang
                version: "1.21.4"
                scope: "global"
              - name: python
                version: "3.12.0"
                scope: "global"
              - name: ruby
                version: "3.2.2"
                scope: "global"
              - name: kubectl
                version: "1.28.2"
                scope: "global"
              - name: helm
                version: "3.13.1"
                scope: "global"
              - name: packer
                version: "1.9.4"
                scope: "global"
